<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"> -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script> -->
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <!-- <script src="./server.js"></script> -->
    <!-- <script src="./script.js"></script> -->
    <link rel="stylesheet" href="./style.css">
    <!-- <link rel="preconnect" href="https://fonts.googleapis.com"> -->
    <!-- <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> -->
    <!-- <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100..900&display=swap" rel="stylesheet"> -->
    <script src="https://kit.fontawesome.com/def66b134a.js" crossorigin="anonymous"></script>
    <title>Document</title>
</head>
<body>
<div class="container">
<!------------ HEADER START ------------>
  <header class="main-header">
    <div class="header_intrio">
        <div class="header-title">
            <h1 class="logo">로고 자리</h1>
        </div>
        <div class="header-content">
        
                <!------------ NAV START ------------>
                <nav class="main-nav">
                    <ul>
                        <li><a href="/24.09.01까지 작업한 내용/2.회원가입/회원가입main.html">회원가입</a></li>
                        <li><a href="/24.09.01까지 작업한 내용/3.login/login.html">로그인</a></li>
                        <li><a href="#">내가 쓴 글</a></li>
                    </ul>
                </nav> 
                <!------------ NAV END ------------>
                <div class="search">
                  <form action="">
                      <!-- <input type="text" class="input-search" value="차 이름을 검색해주세요." id="input-search" onclick="clearTextarea()" >
                      <input type= "submit" class="input-search-submit" value="검색"> -->
                      <div class="search_container">    
                          <input class="search_input" type="text" placeholder="Search">
                      </div>
                  </form>
              </div>                  
          </div>
      </div>
  </header>
<!------------ HEADER END ------------>

<!------------ ASIDE START ------------>
    <!-- <aside>없음</aside> -->
<!------------ ASIDE END ------------>

<!-- 브랜드(옵션), 모델명(인풋), 배기량(옵션), 색상(인풋), 이미지(?) -->
<!------------ SECTION START ------------>
    <form id="carForm">

        <table>
            <colgroup>
                <col width="66px">
                <col width="270px">
                <col width="66px">
                <col width="270px">
            </colgroup>
            <tbody>
                <tr>
                    <th><label for="carModel">차량이름 :</label></th>
                    <th colspan="2"><textarea id="comment"></textarea><br></th>
                    <th></th>
                </tr>
                <tr>
                    <th><label for="brand">제조사:</label></th>
                    <td>
                        <select id="brand">
                            <option value="현대">현대</option>
                            <option value="기아">기아</option>
                            <option value="제네시스">제네시스</option>
                            <option value="쉐보레">쉐보레(GM대우)</option>
                            <option value="르노코리아">르노코리아(삼성)</option>
                            <option value="KG모빌리티">KG모빌리티(쌍용)</option>
                        </select><br>
                    </td>
                    <th><label for="carType">차량 종류:</label></th>
                    <td>
                        <select id="carType">
                            <option value="경차">경차</option>
                            <option value="소형차">소형차</option>
                            <option value="중형차">중형차</option>
                            <option value="대형차">대형차</option>
                            <option value="스포츠카">스포츠카</option>
                            <option value="SUV">SUV</option>
                        </select><br>
                    </td>
                </tr>
                <tr>
                    <th><label for="displacement">배기량:</label></th>
                    <td>
                        <select id="displacement">
                            <option value="1000cc 미만">경차 1000cc 미만</option>
                            <option value="1600cc 미만">소형차 1600cc 미만</option>
                            <option value="1600cc ~2000cc 미만">중형차 1600cc ~2000cc 미만</option>
                            <option value="2000cc 이상">대형차 2000cc 이상</option>
                        </select><br>
                    </td>
                    <th><label for="color">색상:</label></th>
                    <td>
                        <select id="color">
                            <option value="흰색">흰색</option>
                            <option value="검정색">검정색</option>
                            <option value="쥐색">쥐색</option>
                            <option value="은색">은색</option>
                            <option value="청색">청색</option>
                        </select><br>
                    </td>
                </tr>
                <tr>
                    <th><label for="carYear">차량 연식:</label></th>
                    <td>
                        <select id="carYear">
                            <option value="2000년~2005년">2000년~2005년</option>
                            <option value="2005년~2010년">2005년~2010년</option>
                            <option value="2011년~2015년">2011년~2015년</option>
                            <option value="2016년~2020년">2016년~2020년</option>
                            <option value="2021년">2021년</option>
                            <option value="2022년">2022년</option>
                            <option value="2023년">2023년</option>
                            <option value="2024년">2024년</option>
                        </select><br>
                    </td>
                    <th><label for="price">가격:</label></th>
                    <td><input type="number" id="price"><br></td>
                </tr>
                <tr>
                    <th></th>
                        <form action="/upload" method="post" enctype="multipart/form-data">
                            <label for="images">이미지 선택:</label>
                            <input type="file" id="images" name="images" accept="image/*" multiple>
                    </th>
                    <th></th>
                    <th></th>
                    <th></th>
                </tr>
            </tbody>
        </table>

        
        

        
        

        <button type="submit">등록</button>
    </form>
<!------------ SECTION END ------------>
<!-- footer -->

<footer class="footer">
  <p>푸터입니다</p>

</footer>
</body>

<script>
    document.getElementById('images').addEventListener('change', async function(event) {
        const files = event.target.files;
        const formData = new FormData();
        
        for (let i = 0; i < files.length; i++) {
            formData.append('images', files[i]);
        }
    
        try {
            const response = await fetch('/upload', {
                method: 'POST',
                body: formData
            });
    
            if (!response.ok) {
                throw new Error('이미지 업로드 실패');
            }
    
            const result = await response.json();
            console.log('업로드 성공:', result);
        } catch (error) {
            console.error('에러 발생:', error);
        }
    });
    
    document.querySelector('#carForm').addEventListener('submit', function(event) {
        event.preventDefault(); // 기본 폼 제출 방지
    
        const data = {
            carModel: document.querySelector('#carModel').value,
            carType: document.querySelector('#carType').value,
            displacement: document.querySelector('#displacement').value,
            color: document.querySelector('#color').value,
            carYear: document.querySelector('#carYear').value,
            price: parseInt(document.querySelector('#price').value),
            comment: document.querySelector('#comment').value
        };
    
        console.log('Form Data:', data); // 폼 데이터 확인
        console.log('JSON Data:', JSON.stringify(data)); // JSON 변환 확인
    
        fetch('http://192.168.0.25:8080/carpost/post', {
            method: 'POST', // POST 요청으로 설정
            headers: {
                'Content-Type': 'application/json',
                'Accept': '*/*'
            },
            body: JSON.stringify(data)
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok ' + response.statusText);
            }
            return response.json();
        })
        .then(data => {
            alert('작성 완료!');
            console.log('Success:', data);
        })
        .catch(error => {
            console.error('Fetch error:', error);
        });
    });
    </script>

</html>